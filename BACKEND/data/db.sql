CREATE TABLE "ENTREPRISE" (
	"USER_NAME"	TEXT NOT NULL,
	"PASSWORD"	TEXT NOT NULL,
	CONSTRAINT pk_entreprise PRIMARY KEY("USER_NAME")
);

CREATE TABLE "EMPLOYE" (
	"NOM"	TEXT NOT NULL,
	"PRENOM"	TEXT NOT NULL,
	"ENTREPRISE_DU_TRAVAIL"	TEXT NOT NULL,
	"DATE_NAISSANCE"	TEXT NOT NULL,
	"NUM_CARTE_NATIONALE"	TEXT NOT NULL,
	"DATE_DEBUT_TRAVAIL"	TEXT NOT NULL,
	"DATE_ARRET_TRAVAIL"	TEXT NOT NULL DEFAULT 'EN TRAVAIL',
	"SALAIRE"	NUMERIC NOT NULL,
	"OBSERVATION"	BLOB DEFAULT 'RIEN',
	"ADDRESSE"	TEXT NOT NULL,
	CONSTRAINT pk_employee PRIMARY KEY("NUM_CARTE_NATIONALE"),
	CONSTRAINT fk_entreprise FOREIGN KEY("ENTREPRISE_DU_TRAVAIL") REFERENCES "ENTREPRISE"("USER_NAME") ON DELETE CASCADE ON UPDATE CASCADE DEFERRABLE INITIALLY DEFERRED 
    CONSTRAINT chk_employe UNIQUE("NOM", "PRENOM")
);


CREATE TABLE "LISTE_PRESENCE" (
	"DATE"	TEXT NOT NULL,
	"NOM_EMPLOYE"	TEXT NOT NULL,
	"PRENOM_EMPLOYE"	TEXT NOT NULL,
	"PRESENT"	TEXT NOT NULL DEFAULT 'NON',
	"TOTAL_HEURS_TRAVAIL"	REAL,
	CONSTRAINT pk_liste_presence PRIMARY KEY("DATE","NOM_EMPLOYE","PRENOM_EMPLOYE"),
    CONSTRAINT fk_employee FOREIGN KEY("NOM_EMPLOYE","PRENOM_EMPLOYE") REFERENCES "EMPLOYE"("NOM","PRENOM") ON DELETE CASCADE ON UPDATE CASCADE DEFERRABLE INITIALLY DEFERRED 
);

CREATE TABLE "PAYEMENT_EN_COURS" (
	"NOM_EMPLOYE"	TEXT NOT NULL,
	"PRENOM_EMPLOYE"	TEXT NOT NULL,
	"DATE_DERNIER_PAYEMENT"	TEXT NOT NULL,
	"DATE_PROCHAIN_PAYEMENT"	TEXT NOT NULL,
	"PRESENCE_AUJOURDHUI"	TEXT NOT NULL DEFAULT 'NON',
	"ABSENCE"	INTEGER NOT NULL DEFAULT 0,
	"TOTAL_JOURS_TRAVAIL"	REAL NOT NULL,
	"SALAIRE_MENSUEL"	REAL NOT NULL,
	"RESTE_A_PAYER"	REAL NOT NULL,
	CONSTRAINT pk_payement_en_cours PRIMARY KEY("NOM_EMPLOYE","PRENOM_EMPLOYE"),
    CONSTRAINT fk_employee FOREIGN KEY("NOM_EMPLOYE","PRENOM_EMPLOYE") REFERENCES "EMPLOYE"("NOM","PRENOM") ON DELETE CASCADE ON UPDATE CASCADE DEFERRABLE INITIALLY DEFERRED
);

CREATE TABLE "PAYEMENT_EN_RETARD" (
	"NOM_EMPLOYE"	TEXT NOT NULL,
	"PRENOM_EMPLOYE"	TEXT NOT NULL,
	"DATE_DU_PAYEMENT"	TEXT NOT NULL,
	"RETARD_DU_PAYEMENT"	TEXT NOT NULL,
	"PAYMENT"	REAL NOT NULL,
	CONSTRAINT pk_payement_en_retard PRIMARY KEY("NOM_EMPLOYE","PRENOM_EMPLOYE","DATE_DU_PAYEMENT"),
	CONSTRAINT fk_employee FOREIGN KEY("NOM_EMPLOYE","PRENOM_EMPLOYE") REFERENCES "PAYEMENT_EN_COURS"("NOM_EMPLOYE","PRENOM_EMPLOYE") ON DELETE CASCADE ON UPDATE CASCADE DEFERRABLE INITIALLY DEFERRED
);

CREATE TABLE "PAYEMENT_REUSSI" (
	"NOM_EMPLOYE"	TEXT NOT NULL,
	"PRENOM_EMPLOYE"	TEXT NOT NULL,
	"DATE_PAYEMENT"	TEXT,
	"PAYEMENT"	TEXT NOT NULL,
	CONSTRAINT pk_payement_reussi PRIMARY KEY("NOM_EMPLOYE","DATE_PAYEMENT","PRENOM_EMPLOYE"),
    CONSTRAINT fk_employee FOREIGN KEY("NOM_EMPLOYE","PRENOM_EMPLOYE") REFERENCES "PAYEMENT_EN_COURS"("NOM_EMPLOYE","PRENOM_EMPLOYE") ON DELETE CASCADE ON UPDATE CASCADE DEFERRABLE INITIALLY DEFERRED 
);

